---
title: "Class 5: Data Viz w/ ggplot"
author: "Ivan Kish (PID:A17262923)"
format: pdf
---

## Background

There are lots of ways to make plots in R. These include so-called "base R" (like the `plot()`) and add on packages like **ggplot2**.

Let's make the same plot with these two graphics systems. We can use the inbuilt `cars` data set:

```{r}
head(cars)
```

With "base R" we an simply:

```{r}
plot(cars)
```

Now let's try ggplot. First I need to install the package using `install.packages("ggplot2")`.

> **N.I.K.** We never run an `install.packages()` in a code chunk otherwise we will re-instll needlessly every time we open the document. 

Every time we want to use an add on we must load it up using `library()`

```{r}
library(ggplot2)
ggplot(cars)
```

Every ggplot needs at least three things: 

1. The **data** i.e.stuff to plot as a data.frame
2. The **aes** ore aesthetics that map the data to the plot 
3. The **geom_* or geometry i.e. the plot type such as points, lines, etc.


```{r}
ggplot(cars) + 
  aes(x=speed, y=dist) + geom_point() + geom_line()
```

```{r}
ggplot(cars) + 
  aes(x=speed, y=dist) + geom_point() + geom_smooth(method= "lm", se=FALSE) + labs(x="Speed(mph)", y="Distance(ft)", title="Stopping Distance of Old Cars") + theme_grey()
```

## Gene Expression Plot

Read some data on the effects of GLP-1 inhibitor (drug) on gene expression:
```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```
Version 1 plot - start simple by geting some ink on the page.

```{r}
ggplot(genes) + aes(Condition1, Condition2,) + geom_point(col="blue", alpha=0.2)
```

Let us color by `state` up, down, or not changing.
```{r}
table(genes$State)
```
```{r}
ggplot(genes) + aes(Condition1, Condition2, col=State) + geom_point() + scale_color_manual(values=c("purple","grey","lightblue")) + theme_bw() + labs(x="Control(no drug)", y ="Drug", title="Expression changes with GLP-1 drug")
```
```{r}

```

## Going further with gapminder

Here we explore the famous `gapminder` data set with some custom plots.

```{r}
# File location online
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
head(gapminder)
```

> Q. How man rows does this data set hae?

```{r}
nrow(gapminder)
```

> How many different continents are in this data set?

```{r}
table(gapminder$continent)
```

Version 1 plot GDP vs LifeExp for all countries

```{r}
ggplot(gapminder) + aes(x=gdpPercap, y=lifeExp,colour=continent) + geom_point()
```

I want to see a plot for each continent - in ggplot lingo this is called "faceting"

```{r}
ggplot(gapminder) + aes(x=gdpPercap, y=lifeExp,colour=continent) + geom_point() +facet_wrap(~continent)
```

## First look at the dplyr package

Another add-on package with a function called `filter()` that we want to use.

```{r}
library(dplyr)
```

```{r}
filter(gapminder, year == 2007, country=="Indonesia")
```

```{r}
input <- filter(gapminder, year == 2007 | year == 1977)
```

```{r}
ggplot(gapminder) + aes(x=gdpPercap, y=lifeExp, colour = continent) + geom_point() + filter(gapminder, year == 2007 | year ==1997) + facet_wrap(~year)
```

